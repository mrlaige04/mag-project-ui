<div class="login-page">
  <h3 class="my-0 text-2xl">Welcome Back!</h3>
  <p class="text-color-secondary">Enter your credentials to access your account</p>

  @if (apiError()) {
    <p-message severity="error">{{ apiError()?.message }}</p-message>
  }

  <form [formGroup]="form" (ngSubmit)="submit()">
    <div class="fields mt-5">
      @if (state() === LoginStep.PhonePassword) {
        <app-labeled-input label="Phone Number" [error]="phoneErrorMessage">
          @let phoneControl = form.get('phone');
          <input pInputText formControlName="phone" type="text" placeholder="+380987654321" />
        </app-labeled-input>
        <app-labeled-input label="Password" class="mt-3" [error]="passwordErrorMessage">
          <p-password fluid placeholder="*********" formControlName="password" [feedback]="false"/>
        </app-labeled-input>
      } @else {
        <app-labeled-input label="Two Factor Code">
          <input pInputText formControlName="twoFactorCode" type="text" placeholder="123456"/>
        </app-labeled-input>
      }
    </div>
    <div class="pre-actions mt-2">
      <p-button routerLink="/auth/forgot" link text>Forgot password?</p-button>
    </div>
    <div class="actions flex flex-column gap-4 mt-2 align-items-center">
      <p-button [disabled]="!form.valid" type="submit" [loading]="isLoading()" class="w-full" fluid>
        Login
      </p-button>
      <span class="flex align-content-center gap-1 text-center">
      Don't have an account?
      <a routerLink="/auth/register">
        Register
      </a>
    </span>
    </div>
  </form>
</div>
